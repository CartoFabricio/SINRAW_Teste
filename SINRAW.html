<!DOCTYPE html>
<html lang="en">
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

		<title>SINRAW</title>

		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

		<link href="./Bootstrap/bootstrap.css" rel="stylesheet">
    <link href="./Bootstrap/bootstrap-responsive.css" rel="stylesheet">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://getbootstrap.com/2.3.2/assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://getbootstrap.com/2.3.2/assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://getbootstrap.com/2.3.2/assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="https://getbootstrap.com/2.3.2/assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="https://getbootstrap.com/2.3.2/assets/ico/favicon.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <link type="text/css" rel="stylesheet" href="/icons/GlyphiconsV2/font/glyphicons.css" media="all">
    <link type="text/css" rel="stylesheet" href="/icons/GlyphiconsV2/font/style.css" media="all">

		<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
		<script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
		<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
		<script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>

		<script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.js"></script>
		<link href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.9.2/mapbox-gl.css" rel="stylesheet">
		<script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.js"></script>
		<link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-directions/v4.1.0/mapbox-gl-directions.css" type="text/css">


<style>

#menu{position: fixed; top: 0%; width: 100%;  z-index: 3;}
#AR { position: fixed; top: 6%; bottom: 0%; left:0%; width: 100%; z-index: 1;}
#map { position: fixed; top: 69%; bottom: 0%; left:0; width: 100%;  z-index: 1;}
#instructions {
  position: relative;
  width: 0%;
  height:0%;
  background-color: #fff;
  font-family: sans-serif;
  z-index: 1;
}
.informacoes {
  position: fixed;
  width: 20%;
  height:20%;
  top:30%;
  background-color: #fff;
  font-family: sans-serif;
  z-index: 2;
}
.direction {
  position: absolute;
  z-index:2;
  max-width: 100px;
  width: 30%;
  height: 10%;
  left: 0%;
  top: 7%;
}
.nav{padding-left: 5%}
#collapse1{
  padding-right: 15%:
}

.map-overlay {
    font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    position: fixed;
    width: 100%;
    background-color: rgba(0,0,0,0) !important;
    top: 15%;
    left: 90%;
    z-index: 1;
}

.map-overlay-inner {
  position: fixed;
  width: 70%;
  top: 25%;
  left: 15%;
  background-color: rgba(0,0,0,0) !important;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  border-style: solid;
  border-radius: 3px;
  border-color: #598CB3;
  padding: 10px;
  z-index: 2;
}

.map-overlay-inner fieldset {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  border: none;
  padding: 0;
  margin: 0 0 10px;
}

.map-overlay-inner fieldset:last-child {
  margin: 0;
}

.map-overlay-inner select {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  width: 100%;
}


.map-overlay-inner label {
  font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
  display: block;
  font-weight: bold;
  margin: 0 0 5px;
  text-shadow: 0 0 3px #FFFFFF, 0 0 5px #FFFFFF;
}

.map-overlay-inner button {
  display: inline-block;
  width: 36px;
  height: 20px;
  border: 1px;
  cursor: pointer;
}

.map-overlay-inner button:focus {
  outline: none;
}

.map-overlay-inner button:hover {
  box-shadow: inset 0 0 0 3px rgba(0, 0, 0, 0.1);
}

.marker {
    background-image: url('https://www.dropbox.com/s/svexsguknik1vio/Restaurante1.png?dl=1');
    width: 12.5px;
    height: 25px;
  }

.marker1 {
    background-image: url('https://www.dropbox.com/s/i0io5eloarhksre/entrada.png?dl=1');
    width: 20px;
    height: 20px;
  }

.marker2 {
    background-image: url('https://www.dropbox.com/s/rlcoj089fj39w83/Onibus.png?dl=1');
    width: 22px;
    height: 20px;
  }
.marker3 {
    background-image: url('https://www.dropbox.com/s/zmrpt0gofg5b8qu/Correios.png?dl=1');
    width: 25px;
    height: 17px;
  }
.marker4 {
    background-image: url('https://www.dropbox.com/s/xr7xqazmgoohldl/Estacionamento.png?dl=1');
    width: 15px;
    height: 12px;
  }
.marker, .marker1, .marker2, .marker3, .marker4 {
    background-size: cover;
    border-radius: 10%;
    cursor: pointer;
  }
.mapboxgl-popup {
    position:fixed;
    left:50%;
    top: 25%;
    height: 50%;
    width: 350px;
    transform:none !important;
  }

.mapboxgl-popup-content {
    text-align: center;
    font-family: 'Open Sans', sans-serif;
  }
}
.mapboxgl-popup-anchor-top .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-center .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-left .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-right .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip,
.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{
    display:none !important;
}

</style>

	<div id = 'menu'>
		<div class="navbar navbar-inverse navbar-fixed-top">
					<div class="navbar-inner">
						<div class="container-fluid">
							<button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>
							<div class="nav-collapse collapse">
								<ul class="nav">
									<li><a href="./index.html">Inﾃｭcio</a>
									<li><a href="./Simbolos3D.html">Visualizaﾃｧﾃ｣o 3D</a></li>
									<li><a href="./Avaliacao.html">Avalie-nos</a></li>
									<li><a href="./Contato.html">Contato</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
		</div>
</head>

<body>
	<div id="direction" class="direction"></div>

	<div id="AR">
		<iframe src="ARJS.html"  width= "100%" height="67%"  ></iframe>
	</div>

	<div id="map" class="mapboxgl-map">
		<div class="mapboxgl-canary" style="visibility: hidden;"></div>
		<div class="mapboxgl-canvas-container mapboxgl-interactive mapboxgl-touch-drag-pan mapboxgl-touch-zoom-rotate">
			<canvas class="mapboxgl-canvas" tabindex="0" aria-label="Map" role="region" width="811" height="657" style="width: 811px; height: 657px;"></canvas>
		</div>
	</div>

		<div class="map-overlay" >
	    <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#demo"><span class="glyphicon glyphicon-cog" aria-hidden="true"> </button>
	    <div id="demo" class="collapse">
          <div class="map-overlay-inner">
               <fieldset>
                  <label>Mapa Base</label>
                  <select id='basemap-selector' name='basemap-selector'>
                      <option value='mapbox://styles/mapbox/light-v10'>Light</option>
                      <option value='mapbox://styles/mapbox/streets-v11'>Streets</option>
                      <option value='mapbox://styles/mapbox/satellite-v9'>Satellite</option>
                      <option value='mapbox://styles/mapbox/dark-v10'>Dark</option>
                      <option value='mapbox://styles/mapbox/outdoors-v11'>Outdoors</option>
                      <option value='mapbox://styles/mapbox/navigation-day-v1'>navigation-day</option>
                      <option value='mapbox://styles/mapbox/navigation-night-v1'>navigation-night</option>
                  </select>
              </fieldset>
              <fieldset>
								<label>Rotaﾃｧﾃ｣o (0 a 360 graus)<span id="slider-value1"></span></label>
								<input type='range' id='bearing-slider' min='0' max='360' value='0' step='1'>

                <label>ﾃＯgulo da Cﾃ｢mera (0 a 90 graus)<span id="pitch-slider-value"></span></label>
                <input type='range' id='pitch-slider' min='0' max='90' value='80' step='1'>

              </fieldset>
              <fieldset>
                  <label>Editar camada</label>
                  <select id="layer" name="layer">
                      <option value="building">Contruﾃｧﾃｵes</option>
                      <option value="water">ﾃ“ua</option>
                      <option class="landuse" >ﾃ〉ea Verde</option>
                      <option value="triangles">Triangles</option>
                  </select>
              </fieldset>
              <fieldset>
                  <label>Cor de preenchimento</label>
                  <div id="swatches"></div>
              </fieldset>
          </div>
      </div>
   </div>
	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="./Bootstrap/jquery.js.download"></script>
	<script src="./Bootstrap/bootstrap-transition.js.download"></script>
	<script src="./Bootstrap/bootstrap-alert.js.download"></script>
	<script src="./Bootstrap/bootstrap-modal.js.download"></script>
	<script src="./Bootstrap/bootstrap-dropdown.js.download"></script>
	<script src="./Bootstrap/bootstrap-scrollspy.js.download"></script>
	<script src="./Bootstrap/bootstrap-tab.js.download"></script>
	<script src="./Bootstrap/bootstrap-tooltip.js.download"></script>
	<script src="./Bootstrap/bootstrap-popover.js.download"></script>
	<script src="./Bootstrap/bootstrap-button.js.download"></script>
	<script src="./Bootstrap/bootstrap-collapse.js.download"></script>
	<script src="./Bootstrap/bootstrap-carousel.js.download"></script>
	<script src="./Bootstrap/bootstrap-typeahead.js.download"></script>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiZmFicmljaW9hbW9yaW0iLCJhIjoiY2tsaWNsOHRkMmgwaDJucGN0NGJhd3psOSJ9.h665zPxHXNFNVIzh1cJeUQ';

navigator.geolocation.getCurrentPosition( function(position) {
  var lng = position.coords.longitude;
  var lat = position.coords.latitude;
  mapboxgl.accessToken = mapboxgl.accessToken;
  sessionStorage.setItem("lng", lng);
  sessionStorage.setItem("lat", lat);
  const map = new mapboxgl.Map({
    style: 'mapbox://styles/mapbox/light-v10',
    center: [lng, lat], //longitude, latitude
    zoom: 21,
    pitch: 80,
    bearing: 0,
    container: 'map',
    antialias: false,
    attributionControl:false,
  });

  var basemapSelector = document.getElementById('basemap-selector');
  basemapSelector.addEventListener('change', function () {
    var basemap = basemapSelector.value;
    map.setStyle(basemap);
  });


  var pitchSlider = document.getElementById('pitch-slider');
  pitchSlider.addEventListener('input', function () {
    var pitch = Number(pitchSlider.value);
    map.setPitch(pitch);
  });

  var bearingSlider = document.getElementById('bearing-slider');
  bearingSlider.addEventListener('input', function () {
    var bearing = Number(bearingSlider.value);
    map.setBearing(bearing);
  });

  map.on('load', () => {
      // Add a custom layer that uses
      // a vector tileset source.
      map.addLayer({
          id: 'triangles',
          source: {
              type: 'vector',
              url: 'mapbox://examples.ckv9z0wgf5v7c27p7me2mf0l9-9wrve' // custom tileset
          },
          'source-layer': 'triangles',
          type: 'fill'
      });
  });

  const swatches = document.getElementById('swatches');
  const layer = document.getElementById('layer');
  const colors = [
      '#ffffcc',
      '#a1dab4',
      '#41b6c4',
      '#2c7fb8',
      '#253494',
      '#fed976',
      '#feb24c',
      '#fd8d3c',
      '#f03b20',
      '#bd0026',
      '#000000',
      '#FFFFFF',
  ];

  for (const color of colors) {
      const swatch = document.createElement('button');
      swatch.style.backgroundColor = color;
      swatch.addEventListener('click', () => {
          map.setPaintProperty(layer.value, 'fill-color', color);
      });
      swatches.appendChild(swatch);
  }

map.addControl(new mapboxgl.AttributionControl({
    compact: true
  }), 'bottom-right')

  map.on('load', function () {
       map.addSource('layer1', {
           type: 'geojson',
           data: './Geojson/RU.geojson'
       });

       map.addLayer({
           id: 'layer1',
           type: 'fill',
           source: 'layer1',
           paint: {
               'fill-color': '#f00',
               'fill-opacity': 0.5
           },
           layout: {
               'visibility': 'visible'
           }
       });

       map.addSource('layer2', {
           type: 'geojson',
           data: 'path/to/Correios.geojson',
       });

       map.addLayer({
           id: 'layer2',
           type: 'line',
           source: 'layer2',
           paint: {
               'line-color': '#00f',
               'line-width': 2
           },
           layout: {
               'visibility': 'none'
           }
       });

       var layerRadioButtons = document.getElementsByName('camada');

       for (var i = 0; i < layerRadioButtons.length; i++) {
           layerRadioButtons[i].addEventListener('change', function() {
               var layerId = this.value;
               map.setLayoutProperty('layer1', 'visibility', layerId === 'layer1' ? 'visible' : 'none');
               map.setLayoutProperty('layer2', 'visibility', layerId === 'layer2' ? 'visible' : 'none');
           });
       }
   });

   const geojson = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.235028, -25.449557]
          },
          'properties': {
            'title': 'RU',
            'description': 'Restaurante Universitﾃ｡rio'
          }
        },
      ]
    };

    const geojson1 = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.229949, -25.451687]
          },
          'properties': {
            'title': 'Mapbox',
            'description': 'Portaria'
          }
        },
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.232931, -25.453522]
          },
          'properties': {
            'title': 'Mapbox',
            'description': 'Portaria'
          }
        },
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.230441, -25.449003]
          },
          'properties': {
            'title': 'Mapbox',
            'description': 'Portaria'
          }
        }
      ]
    };


    const geojson2 = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.232580, -25.453163]
          },
          'properties': {
            'title': 'Ponto de ﾃ馬ibus',
            'description': 'Ponto de ﾃ馬ibus'
          }
        },
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.232136, -25.449854]
          },
          'properties': {
            'title': 'Ponto de ﾃ馬ibus',
            'description': 'Ponto de ﾃ馬ibus'
          }
        },
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.231291, -25.450282]
          },
          'properties': {
            'title': 'Ponto de ﾃ馬ibus',
            'description': 'Ponto de ﾃ馬ibus'
          }
        },
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.231550, -25.450184]
          },
          'properties': {
            'title': 'Ponto de ﾃ馬ibus',
            'description': 'Ponto de ﾃ馬ibus'
          }
        }
      ]
    };

         const geojson3 = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'geometry': {
            'type': 'Point',
            'coordinates': [-49.234099, -25.44999]
          },
          'properties': {
            'title': 'Correios',
            'description': 'Correios'
          }
        },
      ]
    };

     const geojson4 =   {
    "type": "FeatureCollection",
    "features": [
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.233085960737924,
            -25.453344376797858
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23354358116649,
            -25.453187921663584
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23282382864804,
            -25.453051524714468
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23257058239133,
            -25.4525661107876
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23213331089232,
            -25.453098276993444
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23144208152905,
            -25.451743710824402
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23181972945565,
            -25.451839992085638
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.233814601085186,
            -25.452473841045702
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.233485825243434,
            -25.451787838988665
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.233112620233754,
            -25.45097345720221
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23224625146139,
            -25.451860049915567
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23196634770443,
            -25.451254279129785
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23080230869519,
            -25.451559174926842
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.232333417311594,
            -25.45015945481181
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23350634734177,
            -25.450785289871703
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23358325450266,
            -25.449893455622558
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.233712099088876,
            -25.4498493260068
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.234609568278984,
            -25.450045903260985
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23063575000012,
            -25.44960241230737
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.231398728557224,
            -25.44807491690277
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.231660321594376,
            -25.447630050165046
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.2336527885561,
            -25.44729147791888
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.23665128297114,
            -25.452082228467205
          ],
          "type": "Point"
        }
      },
      {
        "type": "Feature",
        "properties": {},
        "geometry": {
          "coordinates": [
            -49.236088857942406,
            -25.45103505227719
          ],
          "type": "Point"
        }
      }
    ]
  };

    // add markers to map
    for (const feature of geojson.features) {
      const el = document.createElement('div');
      el.className = 'marker';
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .setPopup(
          new mapboxgl.Popup({ offset: 25 }) // add popups
            .setHTML(
              `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
            )
        )
        .addTo(map);
    }

    // add markers to map
    for (const feature of geojson1.features) {
      const el = document.createElement('div');
      el.className = 'marker1';
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .setPopup(
          new mapboxgl.Popup({ offset: 25 }) // add popups
            .setHTML(
              `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
            )
        )
        .addTo(map);
    }

    // add markers to map
    for (const feature of geojson2.features) {
      const el = document.createElement('div');
      el.className = 'marker2';
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .setPopup(
          new mapboxgl.Popup({ offset: 25 }) // add popups
            .setHTML(
              `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
            )
        )
        .addTo(map);
    }

    // add markers to map
    for (const feature of geojson3.features) {
      const el = document.createElement('div');
      el.className = 'marker3';
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .setPopup(
          new mapboxgl.Popup({ offset: 25 })
            .setHTML(
              `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
            )
        )
        .addTo(map);
    }

    // add markers to map
     for (const feature of geojson4.features) {
      const el = document.createElement('div');
      el.className = 'marker4';
      new mapboxgl.Marker(el)
        .setLngLat(feature.geometry.coordinates)
        .setPopup(
          new mapboxgl.Popup({ offset: 25 }) // add popups
            .setHTML(
              `<h3>${feature.properties.title}</h3><p>${feature.properties.description}</p>`
            )
        )
        .addTo(map);
    }


direction = new MapboxDirections({
  accessToken: mapboxgl.accessToken,
  language: 'pt-BR',
  showCompass: true,
  geometry: 'polyline',
  unit: 'metric',
  profile: 'mapbox/walking',
  language: 'pt-BR',
  placeholderOrigin: 'Origem',
  placeholderDestination: 'Destino',
  controls: {
      profileSwitcher: false,
      instructions: false,
  },
});

map.on('load', function() {
  var direction = new MapboxDirections({
    accessToken: mapboxgl.accessToken
  });
  direction.setOrigin([lng,lat]);
});

document.getElementById('direction').appendChild(direction.onAdd(map));

// an arbitrary start will always be the same
// only the end or destination will change
const start = [lng, lat];

// create a function to make a directions request
async function getRoute(end) {
  // make directions request using cycling profile
  const query = await fetch(
    `https://api.mapbox.com/directions/v5/mapbox/walking/${start[0]},${start[1]};${end[0]},${end[1]}?steps=true&geometries=geojson&access_token=${mapboxgl.accessToken}`,
    { method: 'GET' }
  );
  const json = await query.json();
  const data = json.routes[0];
  const route = data.geometry.coordinates;
  const geojson = {
    'type': 'Feature',
    'properties': {},
    'geometry': {
      'type': 'LineString',
      'coordinates': route
    }
  };

  // if the route already exists on the map, we'll reset it using setData
  if (map.getSource('route')) {
    map.getSource('route').setData(geojson);
  }
  // otherwise, we'll make a new request
  else {
    map.addLayer({
      'id': 'route',
      'type': 'line',
      'source': {
        'type': 'geojson',
        'data': geojson
      },
      'layout': {
        'line-join': 'round',
        'line-cap': 'round'
      },
      'paint': {
        'line-color': '#3887be',
        'line-width': 0,
        'line-opacity': 0.75
      }
    });
  }

//			document.getElementById("orig").textContent = JSON.stringify(geojson, undefined, 2);

  // get the sidebar and add the instructions
  const instructions = document.getElementById('instructions');
  const steps = data.legs[0].steps;
  let tripInstructions = '';
  for (const step of steps) {
    tripInstructions += `<li>${step.maneuver.instruction}</li>`;
  }
  instructions.innerHTML = `<p><strong>Trip duration: ${Math.floor(
    data.duration / 60
  )} min 泅ｴ </strong></p><ol>${tripInstructions}</ol>`;
}

map.on('load', () => {
  // make an initial directions request that
  // starts and ends at the same location
  getRoute(start);

  // Add destination to the map
  map.addLayer({
    'id': 'point',
    'type': 'circle',
    'source': {
      'type': 'geojson',
      'data': {
        'type': 'FeatureCollection',
        'features': [
          {
            'type': 'Feature',
            'properties': {},
            'geometry': {
              'type': 'Point',
              'coordinates': start
            }
          }
        ]
      }
    },
    'paint': {
      'circle-radius': 0,
      'circle-color': '#3887be'
    }
  });

  // allow the user to click the map to change the destination
  map.on('click', (event) => {
    const coords = Object.keys(event.lngLat).map(
      (key) => event.lngLat[key]
    );
    const end = {
      'type': 'FeatureCollection',
      'features': [
        {
          'type': 'Feature',
          'properties': {},
          'geometry': {
            'type': 'Point',
            'coordinates': coords
          }
        }
      ]
    };
    if (map.getLayer('end')) {
      map.getSource('end').setData(end);
    } else {
      map.addLayer({
        'id': 'end',
        'type': 'circle',
        'source': {
          'type': 'geojson',
          'data': {
            'type': 'FeatureCollection',
            'features': [
              {
                'type': 'Feature',
                'properties': {},
                'geometry': {
                  'type': 'Point',
                  'coordinates': coords
                }
              }
            ]
          }
        },
        'paint': {
          'circle-radius': 0,
          'circle-color': '#f30'
        }
      });
    }
    getRoute(coords);
  });
});

var nav = new mapboxgl.NavigationControl();
        map.addControl(nav, 'top-left');

map.addControl(new mapboxgl.FullscreenControl());

var geolocate = new mapboxgl.GeolocateControl();
map.addControl(
    geolocate = new mapboxgl.GeolocateControl({
    positionOptions: {
    enableHighAccuracy: true
    },
    trackUserLocation: true,
    showUserHeading: true,
  })
);




map.on('load', () => {
    // Insert the layer beneath any symbol layer.
    const layers = map.getStyle().layers;
    const labelLayerId = layers.find(
        (layer) => layer.type === 'symbol' && layer.layout['text-field']
    ).id;
    geolocate.trigger();

    map.addLayer(
        {
            'id': 'add-3d-buildings',
            'source': 'composite',
            'source-layer': 'building',
            'filter': ['==', 'extrude', 'true'],
            'type': 'fill-extrusion',
            'minzoom': 20,
            'paint': {
                'fill-extrusion-color': '#aaa',
                'fill-extrusion-height': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    15,
                    0,
                    15.05,
                    ['get', 'height']
                ],
                'fill-extrusion-base': [
                    'interpolate',
                    ['linear'],
                    ['zoom'],
                    15,
                    0,
                    15.05,
                    ['get', 'min_height']
                ],
                'fill-extrusion-opacity': 0.6
            } },
        labelLayerId
    );
  });
});

</script>
</body>
</html>
